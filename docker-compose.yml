version: '3'
services:
   mongo:
      container_name: mongo
      image: mongo
      restart: always
      ports:
         - '27017:27017'
      volumes:
         - ./data/db:/data/db

   api_server:
      build:
         context: ./server
         dockerfile: Dockerfile.dev
      volumes:
         - /app/node_modules
         - ./server:/app
      restart: always
      links:
         - mongo # so we can reference mongo using name

   client:
      build:
         context: ./client
         dockerfile: Dockerfile.dev
      #remove this volume in production
      volumes:
         - /app/node_modules
         - ./client:/app

   nginx:
      restart: always
      build:
         context: ./nginx
         dockerfile: Dockerfile.dev
      ports:
         - '3050:80'
